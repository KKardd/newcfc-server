{"version":3,"sources":["../../src/log/logger.middleware.ts"],"sourcesContent":["import { Injectable, NestMiddleware } from '@nestjs/common';\n\nimport { NextFunction, Request, Response } from 'express';\n\nimport { logging } from '@/log/logging';\n\n@Injectable()\nexport class LoggerMiddleware implements NestMiddleware {\n  private readonly logger = logging();\n\n  use(request: Request, response: Response, next: NextFunction): void {\n    const { method, originalUrl } = request;\n    const userAgent = request.get('user-agent') || '';\n    const ip = request.ip;\n\n    this.logger.log(`Request: ${method} ${originalUrl} - ${userAgent} ${ip}`);\n\n    response.on('close', () => {\n      const { statusCode } = response;\n      const contentLength = response.get('content-length');\n      this.logger.log(`Response close: ${method} ${originalUrl} ${statusCode} ${contentLength} - ${userAgent} ${ip}`);\n    });\n\n    next();\n  }\n}\n"],"names":["LoggerMiddleware","use","request","response","next","method","originalUrl","userAgent","get","ip","logger","log","on","statusCode","contentLength","logging"],"mappings":";;;;+BAOaA;;;eAAAA;;;wBAP8B;yBAInB;;;;;;;AAGjB,IAAA,AAAMA,mBAAN,MAAMA;IAGXC,IAAIC,OAAgB,EAAEC,QAAkB,EAAEC,IAAkB,EAAQ;QAClE,MAAM,EAAEC,MAAM,EAAEC,WAAW,EAAE,GAAGJ;QAChC,MAAMK,YAAYL,QAAQM,GAAG,CAAC,iBAAiB;QAC/C,MAAMC,KAAKP,QAAQO,EAAE;QAErB,IAAI,CAACC,MAAM,CAACC,GAAG,CAAC,CAAC,SAAS,EAAEN,OAAO,CAAC,EAAEC,YAAY,GAAG,EAAEC,UAAU,CAAC,EAAEE,IAAI;QAExEN,SAASS,EAAE,CAAC,SAAS;YACnB,MAAM,EAAEC,UAAU,EAAE,GAAGV;YACvB,MAAMW,gBAAgBX,SAASK,GAAG,CAAC;YACnC,IAAI,CAACE,MAAM,CAACC,GAAG,CAAC,CAAC,gBAAgB,EAAEN,OAAO,CAAC,EAAEC,YAAY,CAAC,EAAEO,WAAW,CAAC,EAAEC,cAAc,GAAG,EAAEP,UAAU,CAAC,EAAEE,IAAI;QAChH;QAEAL;IACF;;aAhBiBM,SAASK,IAAAA,gBAAO;;AAiBnC"}