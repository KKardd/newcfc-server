{"version":3,"sources":["../../../../src/adapter/inbound/dto/swagger.decorator.ts"],"sourcesContent":["/* eslint-disable @typescript-eslint/no-explicit-any */\nimport { Type, applyDecorators } from '@nestjs/common';\nimport { ApiExtraModels, ApiResponse, getSchemaPath } from '@nestjs/swagger';\n\nimport { PaginationResponse } from '@/adapter/inbound/dto/common/pagination.dto';\nimport { BUILT_IN_TYPES } from '@/constants';\n\nfunction isBuiltInType(type: Type<unknown>): boolean {\n  return BUILT_IN_TYPES.some((item) => item === type);\n}\n\nexport const ApiSuccessResponse = (\n  status: number,\n  type: Type<unknown>,\n  options?: {\n    isArray?: boolean;\n    paginated?: boolean;\n    description?: string;\n    example?: any;\n  },\n) => {\n  if (isBuiltInType(type)) {\n    return ApiResponse({\n      status,\n      description: options?.description,\n      schema: {\n        type: 'object',\n        properties: {\n          data: {\n            type: options?.isArray ? 'array' : type.name.toLowerCase(),\n            items: options?.isArray ? { type: type.name.toLowerCase() } : undefined,\n          },\n        },\n      },\n      example: options?.example,\n    });\n  }\n\n  return applyDecorators(\n    ApiExtraModels(type),\n    ApiResponse({\n      status,\n      description: options?.description,\n      schema: options?.paginated\n        ? {\n            allOf: [\n              { $ref: getSchemaPath(PaginationResponse) },\n              {\n                properties: {\n                  data: {\n                    type: 'array',\n                    items: { $ref: getSchemaPath(type) },\n                  },\n                },\n              },\n            ],\n          }\n        : {\n            properties: {\n              data: options?.isArray\n                ? {\n                    type: 'array',\n                    items: { $ref: getSchemaPath(type) },\n                  }\n                : {\n                    $ref: getSchemaPath(type),\n                  },\n            },\n          },\n      example: options?.example,\n    }),\n  );\n};\n\nexport const ApiFailResponse = (\n  status: number,\n  errors: {\n    example: string;\n    response: {\n      errorCode: string;\n      message: string;\n    };\n  }[],\n) => {\n  return applyDecorators(\n    ApiResponse({\n      status,\n      content: {\n        'application/json': {\n          examples: errors.reduce((acc: Record<string, any>, { example, response }) => {\n            acc[example] = {\n              value: {\n                timestamp: new Date().toISOString(),\n                path: '/path',\n                httpStatus: status,\n                ...response,\n              },\n            };\n            return acc;\n          }, {}),\n        },\n      },\n    }),\n  );\n};\n"],"names":["ApiFailResponse","ApiSuccessResponse","isBuiltInType","type","BUILT_IN_TYPES","some","item","status","options","ApiResponse","description","schema","properties","data","isArray","name","toLowerCase","items","undefined","example","applyDecorators","ApiExtraModels","paginated","allOf","$ref","getSchemaPath","PaginationResponse","errors","content","examples","reduce","acc","response","value","timestamp","Date","toISOString","path","httpStatus"],"mappings":"AAAA,qDAAqD;;;;;;;;;;;IA0ExCA,eAAe;eAAfA;;IA/DAC,kBAAkB;eAAlBA;;;wBAVyB;yBACqB;+BAExB;2BACJ;AAE/B,SAASC,cAAcC,IAAmB;IACxC,OAAOC,yBAAc,CAACC,IAAI,CAAC,CAACC,OAASA,SAASH;AAChD;AAEO,MAAMF,qBAAqB,CAChCM,QACAJ,MACAK;IAOA,IAAIN,cAAcC,OAAO;QACvB,OAAOM,IAAAA,oBAAW,EAAC;YACjBF;YACAG,aAAaF,SAASE;YACtBC,QAAQ;gBACNR,MAAM;gBACNS,YAAY;oBACVC,MAAM;wBACJV,MAAMK,SAASM,UAAU,UAAUX,KAAKY,IAAI,CAACC,WAAW;wBACxDC,OAAOT,SAASM,UAAU;4BAAEX,MAAMA,KAAKY,IAAI,CAACC,WAAW;wBAAG,IAAIE;oBAChE;gBACF;YACF;YACAC,SAASX,SAASW;QACpB;IACF;IAEA,OAAOC,IAAAA,uBAAe,EACpBC,IAAAA,uBAAc,EAAClB,OACfM,IAAAA,oBAAW,EAAC;QACVF;QACAG,aAAaF,SAASE;QACtBC,QAAQH,SAASc,YACb;YACEC,OAAO;gBACL;oBAAEC,MAAMC,IAAAA,sBAAa,EAACC,iCAAkB;gBAAE;gBAC1C;oBACEd,YAAY;wBACVC,MAAM;4BACJV,MAAM;4BACNc,OAAO;gCAAEO,MAAMC,IAAAA,sBAAa,EAACtB;4BAAM;wBACrC;oBACF;gBACF;aACD;QACH,IACA;YACES,YAAY;gBACVC,MAAML,SAASM,UACX;oBACEX,MAAM;oBACNc,OAAO;wBAAEO,MAAMC,IAAAA,sBAAa,EAACtB;oBAAM;gBACrC,IACA;oBACEqB,MAAMC,IAAAA,sBAAa,EAACtB;gBACtB;YACN;QACF;QACJgB,SAASX,SAASW;IACpB;AAEJ;AAEO,MAAMnB,kBAAkB,CAC7BO,QACAoB;IAQA,OAAOP,IAAAA,uBAAe,EACpBX,IAAAA,oBAAW,EAAC;QACVF;QACAqB,SAAS;YACP,oBAAoB;gBAClBC,UAAUF,OAAOG,MAAM,CAAC,CAACC,KAA0B,EAAEZ,OAAO,EAAEa,QAAQ,EAAE;oBACtED,GAAG,CAACZ,QAAQ,GAAG;wBACbc,OAAO;4BACLC,WAAW,IAAIC,OAAOC,WAAW;4BACjCC,MAAM;4BACNC,YAAY/B;4BACZ,GAAGyB,QAAQ;wBACb;oBACF;oBACA,OAAOD;gBACT,GAAG,CAAC;YACN;QACF;IACF;AAEJ"}